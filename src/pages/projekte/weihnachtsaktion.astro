---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Gorlitz from '../../assets/images/christmas/gorlitz.png';
import Gorlitz2 from '../../assets/images/christmas/gorlitz-2.jpeg';
import Getuausgabe1 from '../../assets/images/christmas/getu-ausgabe-1.jpeg';
import Getuasgabe2 from '../../assets/images/christmas/getu-ausgabe-2.jpeg';
import Getuasgabe3 from '../../assets/images/christmas/getu-ausgabe-3.jpeg';
import Getuasgabe4 from '../../assets/images/christmas/getu-ausgabe-4.jpeg';
import Getuasgabe5 from '../../assets/images/christmas/getu-ausgabe-5.jpg';
import Getuasgabe6 from '../../assets/images/christmas/getu-ausgabe-6.jpeg';
import Getuasgabe7 from '../../assets/images/christmas/getu-ausgabe-7.jpeg';
import Gorlitz3 from '../../assets/images/christmas/gorlitz-3.jpeg';

const galleryImages = [
  { src: Getuausgabe1.src, alt: 'Essensverteilung im Park' },
  { src: Getuasgabe2.src, alt: 'Willkommen im Gorlitzer Park' },
  { src: Getuasgabe3.src, alt: 'Freiwillige mit Weihnachtsmutzen' },
  { src: Gorlitz2.src, alt: 'Freiwillige bei Kottbusser Tor' },
  { src: Gorlitz3.src, alt: 'Familie erhalt Hilfe' },
  { src: Getuasgabe4.src, alt: 'Helfer bereiten Essen vor' },
  { src: Getuasgabe5.src, alt: 'Freiwillige mit festlicher Kleidung' },
  { src: Getuasgabe6.src, alt: 'Gemeinschaft beim Helfen' },
  { src: Getuasgabe7.src, alt: 'Weihnachtsfreude teilen' },
];
---

<BaseLayout title="Weihnachtsaktion - GeTu Prospects e.V.">
  <!-- Cinematic Hero -->
  <section class="hero relative h-screen bg-charcoal overflow-hidden">
    <!-- Background with Ken Burns -->
    <div class="hero-bg absolute inset-0">
      <img
        src={Gorlitz.src}
        alt="Weihnachtsaktion - Verteilung an Obdachlose"
        class="w-full h-full object-cover"
      />
      <div class="absolute inset-0 bg-charcoal/60"></div>
    </div>

    <!-- Cinematic letterbox bars -->
    <div class="hero-letterbox-top absolute top-0 left-0 right-0 h-16 lg:h-24 bg-charcoal z-20"></div>
    <div class="hero-letterbox-bottom absolute bottom-0 left-0 right-0 h-16 lg:h-24 bg-charcoal z-20"></div>

    <!-- Main content grid -->
    <div class="relative z-10 h-full flex flex-col justify-center">
      <div class="container mx-auto px-8 md:px-16">
        <div class="grid lg:grid-cols-12 gap-8 items-center">
          <!-- Left: Big Typography -->
          <div class="lg:col-span-7">
            <!-- Year badge with line -->
            <div class="hero-date opacity-0 flex items-center gap-4 mb-8">
              <div class="w-12 h-px bg-terracotta"></div>
              <span class="text-terracotta text-sm font-semibold uppercase tracking-[0.3em]">
                26. Dezember 2024
              </span>
            </div>

            <!-- Main title - Cinematic stacked -->
            <h1 class="mb-8">
              <span class="hero-title-1 opacity-0 block text-5xl md:text-7xl lg:text-8xl xl:text-9xl font-display font-bold text-white leading-[0.9] tracking-tight">
                Weihnachts
              </span>
              <span class="hero-title-2 opacity-0 block text-5xl md:text-7xl lg:text-8xl xl:text-9xl font-display font-bold text-terracotta leading-[0.9] tracking-tight">
                aktion
              </span>
            </h1>

            <!-- Tagline with reveal -->
            <div class="hero-tagline opacity-0 overflow-hidden">
              <p class="text-xl md:text-2xl text-white/60 max-w-lg leading-relaxed">
                Seit 8 Jahren bringen wir Hoffnung und Warme<br class="hidden md:block"/>
                zu Berlins Obdachlosen.
              </p>
            </div>
          </div>

          <!-- Right: Stats column -->
          <div class="lg:col-span-5 lg:pl-12">
            <div class="hero-stats-block opacity-0 border-l border-white/10 pl-8 space-y-8">
              <div>
                <span class="block text-6xl lg:text-7xl font-display font-bold text-white leading-none">150<span class="text-terracotta">+</span></span>
                <span class="text-white/50 text-sm uppercase tracking-wider mt-2 block">Menschen erreicht</span>
              </div>
              <div>
                <span class="block text-6xl lg:text-7xl font-display font-bold text-white leading-none">8</span>
                <span class="text-white/50 text-sm uppercase tracking-wider mt-2 block">Jahre Tradition</span>
              </div>
              <div>
                <span class="block text-6xl lg:text-7xl font-display font-bold text-white leading-none">30<span class="text-terracotta">+</span></span>
                <span class="text-white/50 text-sm uppercase tracking-wider mt-2 block">Freiwillige Helfer</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bottom scroll indicator -->
    <div class="absolute bottom-24 lg:bottom-32 left-1/2 -translate-x-1/2 z-30">
      <div class="hero-scroll opacity-0 flex flex-col items-center gap-3">
        <div class="w-6 h-10 border border-white/30 rounded-full flex justify-center pt-2">
          <div class="w-1 h-2 bg-terracotta rounded-full animate-bounce"></div>
        </div>
        <span class="text-white/40 text-xs uppercase tracking-[0.2em]">Entdecken</span>
      </div>
    </div>

    <!-- Corner accent -->
    <div class="absolute top-16 lg:top-24 right-8 md:right-16 z-10">
      <div class="hero-corner opacity-0 flex items-center gap-3 text-white/40">
        <span class="text-xs uppercase tracking-wider">Berlin</span>
        <div class="w-8 h-px bg-white/20"></div>
        <span class="text-xs">52.5200Â° N</span>
      </div>
    </div>
  </section>

  <!-- Story Section 1: The Mission -->
  <section class="story-section relative min-h-screen flex items-center bg-[#fffcf7] overflow-hidden">
    <div class="container mx-auto px-8 md:px-16">
      <div class="grid lg:grid-cols-2 gap-12 lg:gap-20 items-center">
        <div class="story-text opacity-0 order-2 lg:order-1">
          <span class="text-terracotta text-sm font-semibold uppercase tracking-[0.3em] block mb-4">
            Die Mission
          </span>
          <h2 class="text-3xl md:text-4xl lg:text-5xl font-display font-semibold text-charcoal leading-tight mb-6">
            Niemand sollte<br/>
            <span class="text-terracotta">Weihnachten allein</span><br/>
            verbringen
          </h2>
          <p class="text-lg text-charcoal-light leading-relaxed mb-6">
            Seit 2016 organisiert GeTu Prospects e.V. jedes Jahr eine
            Weihnachtsausgabe-Aktion in Berlin. Am 26. Dezember - wenn die meisten
            feiern - gehen wir raus auf die Straben.
          </p>
          <p class="text-lg text-charcoal-light leading-relaxed">
            Unser Ziel: Die Liebe Christi weitergeben und den Bedurftigen sowohl
            physische als auch spirituelle Nahrung anbieten.
          </p>
        </div>

        <div class="story-image opacity-0 order-1 lg:order-2 relative">
          <div class="aspect-[4/5] overflow-hidden">
            <img
              src={Gorlitz2.src}
              alt="Freiwillige bei der Essensausgabe"
              class="w-full h-full object-cover"
            />
          </div>
          <!-- Floating caption -->
          <div class="absolute -bottom-6 -left-6 lg:-left-12 bg-charcoal text-white p-6 max-w-xs">
            <p class="text-sm text-white/70 mb-1">Seit</p>
            <p class="text-3xl font-display font-bold text-terracotta">2016</p>
            <p class="text-sm text-white/70">jahrlich organisiert</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Impact Stats - Full Width -->
  <section class="impact-section py-24 lg:py-32 bg-charcoal relative overflow-hidden">
    <!-- Background pattern -->
    <div class="absolute inset-0 opacity-5">
      <div class="absolute top-0 left-1/4 w-96 h-96 bg-terracotta rounded-full blur-3xl"></div>
      <div class="absolute bottom-0 right-1/4 w-64 h-64 bg-terracotta rounded-full blur-3xl"></div>
    </div>

    <div class="container mx-auto px-8 md:px-16 relative z-10">
      <div class="text-center mb-16">
        <span class="text-terracotta text-sm font-semibold uppercase tracking-[0.3em]">
          Weihnachten 2024
        </span>
        <h2 class="mt-4 text-3xl md:text-4xl font-display font-semibold text-white">
          Unser Impact
        </h2>
      </div>

      <div class="grid grid-cols-2 lg:grid-cols-4 gap-8 lg:gap-12 max-w-5xl mx-auto">
        <div class="impact-stat opacity-0 text-center" style="--impact-delay: 0ms">
          <span class="counter block text-5xl md:text-6xl lg:text-7xl font-display font-bold text-terracotta" data-target="150">0</span>
          <span class="block text-white/60 mt-2">Menschen versorgt</span>
        </div>
        <div class="impact-stat opacity-0 text-center" style="--impact-delay: 150ms">
          <span class="counter block text-5xl md:text-6xl lg:text-7xl font-display font-bold text-terracotta" data-target="30">0</span>
          <span class="block text-white/60 mt-2">Freiwillige</span>
        </div>
        <div class="impact-stat opacity-0 text-center" style="--impact-delay: 300ms">
          <span class="counter block text-5xl md:text-6xl lg:text-7xl font-display font-bold text-terracotta" data-target="150">0</span>
          <span class="block text-white/60 mt-2">Warme Mahlzeiten</span>
        </div>
        <div class="impact-stat opacity-0 text-center" style="--impact-delay: 450ms">
          <span class="counter block text-5xl md:text-6xl lg:text-7xl font-display font-bold text-terracotta" data-target="1">0</span>
          <span class="block text-white/60 mt-2">Tag der Hoffnung</span>
        </div>
      </div>
    </div>
  </section>

  <!-- Cinematic Slideshow -->
  <section class="slideshow-section relative h-screen bg-charcoal overflow-hidden">
    <!-- Slides Container -->
    <div class="slideshow-container absolute inset-0">
      {galleryImages.map((image, index) => (
        <div
          class={`slide absolute inset-0 ${index === 0 ? 'active' : ''}`}
          data-index={index}
        >
          <img
            src={image.src}
            alt={image.alt}
            class="slide-image w-full h-full object-cover"
          />
          <div class="absolute inset-0 bg-gradient-to-t from-[#1a1a1a] via-[#1a1a1a]/20 to-[#1a1a1a]/40"></div>
        </div>
      ))}
    </div>

    <!-- Content Overlay -->
    <div class="relative z-10 h-full flex flex-col justify-between py-16 lg:py-24">
      <!-- Top: Title -->
      <div class="container mx-auto px-8 md:px-16">
        <span class="text-terracotta text-sm font-semibold uppercase tracking-[0.3em] block mb-4">
          Galerie
        </span>
        <h2 class="text-3xl md:text-4xl lg:text-5xl font-display font-semibold text-white">
          Momente der<br/>
          <span class="text-terracotta">Hoffnung</span>
        </h2>
      </div>

      <!-- Bottom: Controls & Caption -->
      <div class="container mx-auto px-8 md:px-16">
        <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-8">
          <!-- Caption -->
          <div class="max-w-md">
            <p class="slide-caption text-white/80 text-lg transition-opacity duration-500">
              {galleryImages[0].alt}
            </p>
          </div>

          <!-- Controls -->
          <div class="flex items-center gap-6">
            <!-- Progress dots -->
            <div class="flex gap-2">
              {galleryImages.map((_, index) => (
                <button
                  class={`slide-dot w-2 h-2 rounded-full transition-all duration-300 ${index === 0 ? 'bg-terracotta w-8' : 'bg-white/30 hover:bg-white/50'}`}
                  data-index={index}
                  aria-label={`Go to slide ${index + 1}`}
                />
              ))}
            </div>

            <!-- Counter -->
            <div class="text-white/60 font-mono text-sm">
              <span class="slide-current text-white font-semibold">01</span>
              <span class="mx-1">/</span>
              <span>{String(galleryImages.length).padStart(2, '0')}</span>
            </div>

            <!-- Nav buttons -->
            <div class="flex gap-2">
              <button
                class="slide-prev w-12 h-12 border border-white/20 flex items-center justify-center text-white/60 hover:text-white hover:border-white/40 transition-colors"
                aria-label="Previous slide"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
              </button>
              <button
                class="slide-next w-12 h-12 border border-white/20 flex items-center justify-center text-white/60 hover:text-white hover:border-white/40 transition-colors"
                aria-label="Next slide"
              >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- Progress bar -->
        <div class="mt-8 h-px bg-white/10 overflow-hidden">
          <div class="slide-progress h-full bg-terracotta w-0"></div>
        </div>
      </div>
    </div>

    <!-- Pause indicator -->
    <div class="slide-paused-indicator absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 opacity-0 pointer-events-none transition-opacity">
      <div class="w-20 h-20 bg-white/10 backdrop-blur-sm flex items-center justify-center">
        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 24 24">
          <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
        </svg>
      </div>
    </div>
  </section>

  <!-- Story Section 2: The Result -->
  <section class="py-24 lg:py-32 bg-sand">
    <div class="container mx-auto px-8 md:px-16">
      <div class="max-w-4xl mx-auto">
        <div class="result-text opacity-0 text-center mb-16">
          <span class="text-terracotta text-sm font-semibold uppercase tracking-[0.3em] block mb-4">
            Das Ergebnis
          </span>
          <h2 class="text-3xl md:text-4xl lg:text-5xl font-display font-semibold text-charcoal leading-tight mb-8">
            Ein voller Erfolg
          </h2>
          <p class="text-xl text-charcoal-light leading-relaxed">
            Dank des engagierten Einsatzes unseres Teams konnten wir insgesamt
            150 obdachlose Menschen mit einer warmen Mahlzeit versorgen. Die
            Resonanz aus der Gemeinschaft war uberwaltigen positiv.
          </p>
        </div>

        <!-- Achievements grid -->
        <div class="grid md:grid-cols-2 gap-6">
          <div class="result-card opacity-0 bg-white p-8" style="--result-delay: 0ms">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 bg-terracotta flex items-center justify-center shrink-0">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                </svg>
              </div>
              <div>
                <h3 class="text-lg font-display font-semibold text-charcoal mb-2">
                  Warme Mahlzeiten
                </h3>
                <p class="text-charcoal-light">
                  150 Menschen erhielten eine warme Mahlzeit und ein Stuck Menschlichkeit.
                </p>
              </div>
            </div>
          </div>

          <div class="result-card opacity-0 bg-white p-8" style="--result-delay: 100ms">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 bg-terracotta flex items-center justify-center shrink-0">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                </svg>
              </div>
              <div>
                <h3 class="text-lg font-display font-semibold text-charcoal mb-2">
                  Engagierte Freiwillige
                </h3>
                <p class="text-charcoal-light">
                  Zahlreiche Helfer brachten sich mit Herz und Hingabe ein.
                </p>
              </div>
            </div>
          </div>

          <div class="result-card opacity-0 bg-white p-8" style="--result-delay: 200ms">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 bg-terracotta flex items-center justify-center shrink-0">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                </svg>
              </div>
              <div>
                <h3 class="text-lg font-display font-semibold text-charcoal mb-2">
                  Spirituelle Nahrung
                </h3>
                <p class="text-charcoal-light">
                  Neben Essen auch Trost, Gesprache und Hoffnung geteilt.
                </p>
              </div>
            </div>
          </div>

          <div class="result-card opacity-0 bg-white p-8" style="--result-delay: 300ms">
            <div class="flex items-start gap-4">
              <div class="w-12 h-12 bg-terracotta flex items-center justify-center shrink-0">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/>
                </svg>
              </div>
              <div>
                <h3 class="text-lg font-display font-semibold text-charcoal mb-2">
                  Gemeinschaft gestarkt
                </h3>
                <p class="text-charcoal-light">
                  Zusammenhalt in der Berliner Gemeinschaft gefestigt.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Future Plans - Cinematic Section -->
  <section class="future-section relative min-h-[80vh] flex items-center overflow-hidden">
    <div class="absolute inset-0">
      <img
        src={Getuasgabe5.src}
        alt="Freiwillige in Aktion"
        class="w-full h-full object-cover"
      />
      <div class="absolute inset-0 bg-charcoal/70"></div>
    </div>

    <div class="relative z-10 container mx-auto px-8 md:px-16">
      <div class="max-w-3xl">
        <div class="future-content opacity-0">
          <span class="text-terracotta text-sm font-semibold uppercase tracking-[0.3em] block mb-6">
            Ausblick
          </span>
          <h2 class="text-4xl md:text-5xl lg:text-6xl font-display font-bold text-white leading-tight mb-8">
            Das ist erst<br/>
            <span class="text-terracotta">der Anfang</span>
          </h2>
          <p class="text-xl text-white/80 leading-relaxed mb-6">
            Angespornt durch das positive Feedback erwagt GeTu Prospects e.V.,
            die Weihnachtsausgabe-Aktion nicht nur als feste jahrliche Tradition
            fortzufuhren, sondern auch ihre Reichweite weiter auszubauen.
          </p>
          <p class="text-xl text-white/80 leading-relaxed">
            Daruber hinaus prufen wir Moglichkeiten, uber die Weihnachtszeit
            hinaus nachhaltige Unterstutzung fur obdachlose Menschen in Berlin zu fordern.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Final CTA -->
  <section class="py-24 lg:py-32 bg-terracotta">
    <div class="container mx-auto px-8 md:px-16">
      <div class="max-w-3xl mx-auto text-center">
        <h2 class="text-3xl md:text-4xl lg:text-5xl font-display font-bold text-white leading-tight mb-6">
          Nachstes Jahr dabei sein?
        </h2>
        <p class="text-xl text-white/90 mb-12">
          Melden Sie sich als Freiwilliger an oder unterstutzen Sie die Aktion mit einer Spende.
          Jede Hilfe zahlt.
        </p>

        <div class="flex flex-col sm:flex-row justify-center gap-4">
          <a
            href="/ehrenamtliche-arbeit"
            class="inline-flex items-center justify-center gap-3 bg-white text-terracotta px-10 py-5 font-bold text-lg hover:bg-sand transition-colors"
          >
            Als Freiwillige/r mitmachen
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
            </svg>
          </a>
          <a
            href="/kontakt"
            class="inline-flex items-center justify-center gap-3 border-2 border-white text-white px-10 py-5 font-bold text-lg hover:bg-white hover:text-terracotta transition-colors"
          >
            Kontakt aufnehmen
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Navigation -->
  <section class="py-16 bg-charcoal">
    <div class="container mx-auto px-8 md:px-16">
      <div class="flex justify-between items-center">
        <a href="/projekte/stammtisch" class="flex items-center gap-3 text-white/70 hover:text-white transition-colors group">
          <svg class="w-5 h-5 transform group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16l-4-4m0 0l4-4m-4 4h18"/>
          </svg>
          <span>Stammtisch</span>
        </a>
        <a href="/projekte/youth" class="flex items-center gap-3 text-white/70 hover:text-white transition-colors group">
          <span>Youth with Perspective</span>
          <svg class="w-5 h-5 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
          </svg>
        </a>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  /* Ken Burns effect for hero */
  .hero-bg img {
    animation: kenBurns 20s ease-in-out infinite alternate;
  }

  @keyframes kenBurns {
    0% {
      transform: scale(1.1) translate(0, 0);
    }
    100% {
      transform: scale(1.2) translate(-2%, -1%);
    }
  }

  /* Slideshow styles */
  .slide {
    opacity: 0;
    visibility: hidden;
    transition: opacity 1.2s ease-in-out, visibility 1.2s ease-in-out;
  }

  .slide.active {
    opacity: 1;
    visibility: visible;
  }

  .slide .slide-image {
    transform: scale(1);
    transition: transform 8s ease-out;
  }

  .slide.active .slide-image {
    transform: scale(1.1);
  }

  /* Different Ken Burns directions for variety */
  .slide:nth-child(odd) .slide-image {
    transform-origin: left center;
  }

  .slide:nth-child(even) .slide-image {
    transform-origin: right center;
  }

  .slide:nth-child(3n) .slide-image {
    transform-origin: center top;
  }

  /* Progress bar animation */
  .slide-progress {
    transition: width 0.1s linear;
  }

  .slide-progress.animating {
    transition: width 6s linear;
    width: 100% !important;
  }

  /* Pause indicator */
  .slideshow-section:hover .slide-paused-indicator {
    opacity: 1;
  }

  .slideshow-section:hover .slide-progress {
    animation-play-state: paused;
  }

  /* Letterbox animation */
  .hero-letterbox-top {
    transform: scaleY(3);
    transform-origin: top;
    transition: transform 1.5s cubic-bezier(0.16, 1, 0.3, 1) 0.3s;
  }

  .hero-letterbox-bottom {
    transform: scaleY(3);
    transform-origin: bottom;
    transition: transform 1.5s cubic-bezier(0.16, 1, 0.3, 1) 0.3s;
  }

  .hero.animate .hero-letterbox-top,
  .hero.animate .hero-letterbox-bottom {
    transform: scaleY(1);
  }

  /* Hero animations */
  .hero.animate .hero-date {
    animation: slideInLeft 1s cubic-bezier(0.16, 1, 0.3, 1) 0.8s forwards;
  }

  .hero.animate .hero-title-1 {
    animation: revealUp 1.2s cubic-bezier(0.16, 1, 0.3, 1) 1s forwards;
  }

  .hero.animate .hero-title-2 {
    animation: revealUp 1.2s cubic-bezier(0.16, 1, 0.3, 1) 1.15s forwards;
  }

  .hero.animate .hero-tagline {
    animation: fadeInUp 1s cubic-bezier(0.16, 1, 0.3, 1) 1.4s forwards;
  }

  .hero.animate .hero-stats-block {
    animation: fadeInRight 1s cubic-bezier(0.16, 1, 0.3, 1) 1.6s forwards;
  }

  .hero.animate .hero-scroll {
    animation: fadeInUp 1s cubic-bezier(0.16, 1, 0.3, 1) 2s forwards;
  }

  .hero.animate .hero-corner {
    animation: fadeIn 1s cubic-bezier(0.16, 1, 0.3, 1) 1.8s forwards;
  }

  @keyframes slideInLeft {
    from {
      opacity: 0;
      transform: translateX(-30px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes revealUp {
    from {
      opacity: 0;
      transform: translateY(100%);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeInRight {
    from {
      opacity: 0;
      transform: translateX(40px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  /* Story section animations */
  .story-text.animate,
  .story-image.animate,
  .result-text.animate,
  .future-content.animate {
    animation: fadeInUp 1s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  }

  /* Impact stats */
  .impact-stat.animate {
    animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    animation-delay: var(--impact-delay);
  }

  /* Result cards */
  .result-card.animate {
    animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    animation-delay: var(--result-delay);
  }

  /* Gallery items */
  .gallery-item.animate {
    animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    animation-delay: var(--gallery-delay);
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(40px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeInDown {
    from {
      opacity: 0;
      transform: translateY(-30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeInLeft {
    from {
      opacity: 0;
      transform: translateX(30px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }
</style>

<script>
  const captions = [
    'Essensverteilung im Park',
    'Willkommen im Gorlitzer Park',
    'Freiwillige mit Weihnachtsmutzen',
    'Freiwillige bei Kottbusser Tor',
    'Familie erhalt Hilfe',
    'Helfer bereiten Essen vor',
    'Freiwillige mit festlicher Kleidung',
    'Gemeinschaft beim Helfen',
    'Weihnachtsfreude teilen',
  ];

  function initWeihnachtsPage() {
    const hero = document.querySelector('.hero');
    const sections = document.querySelectorAll('.story-text, .story-image, .impact-stat, .result-text, .result-card, .future-content');
    const counters = document.querySelectorAll('.counter');

    // Hero animation
    if (hero) {
      setTimeout(() => hero.classList.add('animate'), 100);
    }

    // Intersection Observer for scroll animations
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add('animate');
            observer.unobserve(entry.target);
          }
        });
      },
      { threshold: 0.2 }
    );

    sections.forEach((section) => observer.observe(section));

    // Counter animation
    const counterObserver = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const counter = entry.target as HTMLElement;
            const target = parseInt(counter.dataset.target || '0', 10);
            animateCounter(counter, target);
            counterObserver.unobserve(counter);
          }
        });
      },
      { threshold: 0.5 }
    );

    counters.forEach((counter) => counterObserver.observe(counter));

    // Cinematic Slideshow
    initSlideshow();
  }

  function initSlideshow() {
    const slideshowSection = document.querySelector('.slideshow-section');
    if (!slideshowSection) return;

    const slides = document.querySelectorAll('.slide');
    const dots = document.querySelectorAll('.slide-dot');
    const prevBtn = document.querySelector('.slide-prev');
    const nextBtn = document.querySelector('.slide-next');
    const caption = document.querySelector('.slide-caption');
    const counter = document.querySelector('.slide-current');
    const progressBar = document.querySelector('.slide-progress') as HTMLElement;

    let currentIndex = 0;
    let isPaused = false;
    let autoPlayInterval: ReturnType<typeof setInterval>;
    let progressInterval: ReturnType<typeof setInterval>;
    const slideDuration = 6000; // 6 seconds per slide

    function goToSlide(index: number) {
      // Remove active from all slides and dots
      slides.forEach((slide) => slide.classList.remove('active'));
      dots.forEach((dot) => {
        dot.classList.remove('bg-terracotta', 'w-8');
        dot.classList.add('bg-white/30');
      });

      // Set new active
      currentIndex = index;
      if (currentIndex >= slides.length) currentIndex = 0;
      if (currentIndex < 0) currentIndex = slides.length - 1;

      slides[currentIndex].classList.add('active');
      dots[currentIndex].classList.add('bg-terracotta', 'w-8');
      dots[currentIndex].classList.remove('bg-white/30');

      // Update caption
      if (caption) {
        caption.style.opacity = '0';
        setTimeout(() => {
          caption.textContent = captions[currentIndex];
          caption.style.opacity = '1';
        }, 300);
      }

      // Update counter
      if (counter) {
        counter.textContent = String(currentIndex + 1).padStart(2, '0');
      }

      // Reset progress
      resetProgress();
    }

    function nextSlide() {
      goToSlide(currentIndex + 1);
    }

    function prevSlide() {
      goToSlide(currentIndex - 1);
    }

    function resetProgress() {
      if (progressBar) {
        progressBar.style.transition = 'none';
        progressBar.style.width = '0%';

        // Force reflow
        progressBar.offsetHeight;

        if (!isPaused) {
          progressBar.style.transition = `width ${slideDuration}ms linear`;
          progressBar.style.width = '100%';
        }
      }
    }

    function startAutoPlay() {
      stopAutoPlay();
      resetProgress();

      autoPlayInterval = setInterval(() => {
        if (!isPaused) {
          nextSlide();
        }
      }, slideDuration);
    }

    function stopAutoPlay() {
      if (autoPlayInterval) {
        clearInterval(autoPlayInterval);
      }
    }

    // Event listeners
    if (prevBtn) {
      prevBtn.addEventListener('click', () => {
        prevSlide();
        startAutoPlay();
      });
    }

    if (nextBtn) {
      nextBtn.addEventListener('click', () => {
        nextSlide();
        startAutoPlay();
      });
    }

    dots.forEach((dot, index) => {
      dot.addEventListener('click', () => {
        goToSlide(index);
        startAutoPlay();
      });
    });

    // Pause on hover
    slideshowSection.addEventListener('mouseenter', () => {
      isPaused = true;
      if (progressBar) {
        const computedWidth = getComputedStyle(progressBar).width;
        progressBar.style.transition = 'none';
        progressBar.style.width = computedWidth;
      }
    });

    slideshowSection.addEventListener('mouseleave', () => {
      isPaused = false;
      if (progressBar) {
        const currentWidth = parseFloat(progressBar.style.width);
        const remainingTime = slideDuration * (1 - currentWidth / 100);
        progressBar.style.transition = `width ${remainingTime}ms linear`;
        progressBar.style.width = '100%';
      }
    });

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      const rect = slideshowSection.getBoundingClientRect();
      const isVisible = rect.top < window.innerHeight && rect.bottom > 0;

      if (isVisible) {
        if (e.key === 'ArrowLeft') {
          prevSlide();
          startAutoPlay();
        } else if (e.key === 'ArrowRight') {
          nextSlide();
          startAutoPlay();
        }
      }
    });

    // Start slideshow
    startAutoPlay();
  }

  function animateCounter(element: HTMLElement, target: number) {
    const duration = 2000;
    const start = 0;
    const increment = target / (duration / 16);
    let current = start;

    const timer = setInterval(() => {
      current += increment;
      if (current >= target) {
        element.textContent = target.toString() + (target > 1 ? '+' : '');
        clearInterval(timer);
      } else {
        element.textContent = Math.floor(current).toString();
      }
    }, 16);
  }

  initWeihnachtsPage();
  document.addEventListener('astro:page-load', initWeihnachtsPage);
</script>
